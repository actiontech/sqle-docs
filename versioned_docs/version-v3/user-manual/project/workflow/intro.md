---
title: 功能说明
---

# 功能说明
很多公司通常设有 DBA（Database administrator） 这个职位，他们负责在系统上运行数据库，执行备份，执行安全策略等日常数据库运维的工作。其中，DBA一项重要的工作是规范研发人员在应用程序中使用的 SQL 语句。

### 场景举例：
产品在迭代过程中，某个表需要新增一个字段，这会涉及到改表操作。
当前处理方法：DBA 依据数据库规范评估SQL语句的合理性。如果评估没有问题，则将修改操作应用到线上数据库。如果公司对于这类操作比较严格，在上线前，可能还需要经过层层审批。所有上线流程中的人都同意后，再将修改操作应用到数据库。

由此引出的问题：

* SQL上线牵涉范围较广，缺乏规范化流程支撑
* 工单运转节点不透明，需要DBA去手动通知

### 定位
SQLE审核工单的出现主要是为了解决上述整个过程中的规范化、流程化的问题。

* 通过引入审核规则模板，在人工审核前，首先利用规范化的DBA审核经验进行平台预审，提高整体审核效率
* 通过引入审核流程模板，将SQL语句的流程节点透明化，并明确操作权限归属，提供规范化流程支持

### 流程
![process](img/process.png)

| 状态 | 说明 |
| - | -------- |
|待审核	| 创建完的工单自动进入「待审核」状态；该状态的工单将由项目流程设置的审核人进行审核。|
|待上线 |	工单的每一道审核流程均执行通过后，工单状态将由「待审核」状态变更为「待上线」状态；上线人此时可选择立即上线或批量驳回，或针对具体数据源进行立即上线或定时上线。设置定时上线后，工单状态仍为「待上线」，到达预设的上线时间后，变更为「正在上线」状态；设置定时上线但还未到达上线时间的工单，可以由上线人取消定时上线，可以再次对工单进关闭、定时上线/立即上线等操作。|
|正在上线| 当上线人进行立即上线，工单会短暂的进入「正在上线」阶段，该阶段的时间取决于SQL是否上线完毕；当上线人选择定时上线，定时上线的工单到预设时间会自动执行SQL上线，此时工单也会由「待上线」状态变更为「正在上线」状态；SQL上线遇到阻塞的工单会一直处于「正在上线」状态。|
|上线成功|	SQL上线成功的工单会进入「上线成功」状态；上线成功标志工单流转结束，无法再对工单进行操作。|
|上线失败| SQL上线失败的工单会进入「上线失败」状态；上线失败同样标志工单流转结束，无法再对工单进行操作|
|已驳回|「待审核」的工单可以由每级的审批人进行审核，若审核不通过，被驳回，工单将进入「已驳回」状态；此状态的工单可以由创建人或者超管用户进行修改并重新提交工单，流程将被重置。
|已关闭|状态为「待审核」、「待上线」或「已驳回」的工单可以由创建人或者超管用户在任何时刻关闭工单，「已关闭」状态标志工单流转结束，无法再对工单进行操作；已经进入上线流程的工单无法关闭。
